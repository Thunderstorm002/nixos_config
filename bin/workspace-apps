#!/usr/bin/env bash
# Script: rofi-hyprland-switch.sh
# Description: Lists open applications in the current Hyprland workspace and switches to the selected one using rofi

# Get the current workspace ID
WORKSPACE_ID=$(hyprctl activeworkspace -j | jq -r '.id')

# Get the list of windows in the current workspace, format as "class: title" with address as metadata
SELECTION=$(hyprctl clients -j | jq -r ".[] | select(.workspace.id == $WORKSPACE_ID) | \"\(.class): \(.title) [\(.address)]\"" | rofi -dmenu -p "Switch to window in workspace $WORKSPACE_ID")

# Check if a selection was made
if [ -n "$SELECTION" ]; then
  # Extract the address from the selection (format: "class: title [address]")
  ADDRESS=$(echo "$SELECTION" | awk -F'[][]' '{print $2}')
  if [ -n "$ADDRESS" ]; then
    # Switch to the selected window using its address
    hyprctl dispatch focuswindow address:$ADDRESS
  fi
fi
